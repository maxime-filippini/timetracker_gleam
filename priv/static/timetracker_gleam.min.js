var c=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},A=class{static fromArray(t,r){let n=r||new Ye;for(let i=t.length-1;i>=0;--i)n=new ye(t[i],n);return n}[Symbol.iterator](){return new _t(this)}toArray(){return[...this]}atLeastLength(t){for(let r of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let r of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let r of this)t++;return t}};function b(e,t){return new ye(e,t)}function o(e,t){return A.fromArray(e,t)}var _t=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Ye)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Ye=class extends A{},ye=class extends A{constructor(t,r){super(),this.head=t,this.tail=r}},be=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,r,n){return gn(this.buffer,t,r,n)}intFromSlice(t,r,n,i){return wn(this.buffer,t,r,n,i)}binaryFromSlice(t,r){return new e(this.buffer.slice(t,r))}sliceAfter(t){return new e(this.buffer.slice(t))}},Ke=class{constructor(t){this.value=t}};function wn(e,t,r,n,i){let s=0;if(n)for(let u=t;u<r;u++)s=s*256+e[u];else for(let u=r-1;u>=t;u--)s=s*256+e[u];if(i){let l=2**((r-t)*8-1);s>=l&&(s-=l*2)}return s}function gn(e,t,r,n){let i=new DataView(e.buffer),s=r-t;if(s===8)return i.getFloat64(t,!n);if(s===4)return i.getFloat32(t,!n);{let u=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${s*8} bits`;throw new globalThis.Error(u)}}var se=class e extends c{static isResult(t){return t instanceof e}},d=class extends se{constructor(t){super(),this[0]=t}isOk(){return!0}},m=class extends se{constructor(t){super(),this[0]=t}isOk(){return!1}};function $(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!sr(n)||!sr(i)||!En(n,i)||bn(n,i)||kn(n,i)||On(n,i)||vn(n,i)||Ln(n,i)||jn(n,i))return!1;let u=Object.getPrototypeOf(n);if(u!==null&&typeof u.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[l,a]=yn(n);for(let f of l(n))r.push(a(n,f),a(i,f))}return!0}function yn(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function bn(e,t){return e instanceof Date&&(e>t||e<t)}function kn(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function On(e,t){return Array.isArray(e)&&e.length!==t.length}function vn(e,t){return e instanceof Map&&e.size!==t.size}function Ln(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function jn(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function sr(e){return typeof e=="object"&&e!==null}function En(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function ke(e,t){return t===0?0:e%t}function ht(e,t,r,n,i,s){let u=new globalThis.Error(i);u.gleam_error=e,u.module=t,u.line=r,u.fn=n;for(let l in s)u[l]=s[l];return u}var g=class extends c{constructor(t){super(),this[0]=t}},y=class extends c{};function xt(e,t){if(e instanceof g){let r=e[0];return new d(r)}else return new m(t)}function Tn(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=b(i,n)}}}function I(e){return Tn(e,o([]))}function Cn(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return I(s);{let u=n.head;e=n.tail,t=i,r=b(i(u),s)}}}function C(e,t){return Cn(e,t,o([]))}function zn(e,t,r,n){for(;;){let i=e,s=t,u=r,l=n;if(i.hasLength(0))return I(l);{let a=i.head,f=i.tail,h=b(s(a,u),l);e=f,t=s,r=u+1,n=h}}}function Ze(e,t){return zn(e,t,0,o([]))}function Nn(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=b(i,n)}}}function ae(e,t){return Nn(I(e),t)}function fe(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let u=n.head;e=n.tail,t=s(i,u),r=s}}}function pe(e,t){if(e.isOk()){let r=e[0];return new d(t(r))}else{let r=e[0];return new m(r)}}function yt(e,t){if(e.isOk()){let r=e[0];return new d(r)}else{let r=e[0];return new m(t(r))}}function ve(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new m(r)}}function Qe(e){return kt(e)}function et(e){return e}function X(e){return e}function dr(e,t){return mr(e,t)}function Ot(e,t){if(t==="")return bt(e);{let n=et(e),i=dr(n,t);return C(i,X)}}function vt(e){let t=B(e);return X(t)}var de=class extends c{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function Lt(e){return At(e)}function Jn(e){return $r(e)}function hr(e){return t=>{if(e.hasLength(0))return new m(o([new de("another type",Lt(t),o([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let s=i[0];return new d(s)}else return hr(n)(t)}}}function Vn(e,t){let r=t,n=hr(o([jt,s=>pe(Jn(s),D)])),i=(()=>{let s=n(r);if(s.isOk())return s[0];{let u=o(["<",Lt(r),">"]),l=Qe(u);return X(l)}})();return e.withFields({path:b(i,e.path)})}function Yn(e,t){return yt(e,r=>C(r,t))}function jt(e){return xr(e)}function Et(e,t){return r=>{let n=new de("field","nothing",o([]));return ve(wr(r,e),i=>{let u=xt(i,o([n])),l=ve(u,t);return Yn(l,a=>Vn(a,e))})}}var gr=new WeakMap,St=new DataView(new ArrayBuffer(8)),qt=0;function Tt(e){let t=gr.get(e);if(t!==void 0)return t;let r=qt++;return qt===2147483647&&(qt=0),gr.set(e,r),r}function Ct(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Nt(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function yr(e){St.setFloat64(0,e);let t=St.getInt32(0),r=St.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function Kn(e){return Nt(e.toString())}function Xn(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Tt(e);if(e instanceof Date)return yr(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+z(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+z(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+Ct(z(n),z(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],u=e[s];r=r+Ct(z(u),Nt(s))|0}}return r}function z(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return yr(e);case"string":return Nt(e);case"bigint":return Kn(e);case"object":return Xn(e);case"symbol":return Tt(e);case"function":return Tt(e);default:return 0}}var P=5,Ft=Math.pow(2,P),Zn=Ft-1,Qn=Ft/2,ei=Ft/4,L=0,M=1,S=2,Q=3,It={type:S,bitmap:0,array:[]};function Ee(e,t){return e>>>t&Zn}function rt(e,t){return 1<<Ee(e,t)}function ti(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Bt(e,t){return ti(e&t-1)}function N(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function ri(e,t,r){let n=e.length,i=new Array(n+1),s=0,u=0;for(;s<t;)i[u++]=e[s++];for(i[u++]=r;s<n;)i[u++]=e[s++];return i}function zt(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function br(e,t,r,n,i,s){let u=z(t);if(u===n)return{type:Q,hash:u,array:[{type:L,k:t,v:r},{type:L,k:i,v:s}]};let l={val:!1};return Ae(Dt(It,e,u,t,r,l),e,n,i,s,l)}function Ae(e,t,r,n,i,s){switch(e.type){case M:return ni(e,t,r,n,i,s);case S:return Dt(e,t,r,n,i,s);case Q:return ii(e,t,r,n,i,s)}}function ni(e,t,r,n,i,s){let u=Ee(r,t),l=e.array[u];if(l===void 0)return s.val=!0,{type:M,size:e.size+1,array:N(e.array,u,{type:L,k:n,v:i})};if(l.type===L)return $(n,l.k)?i===l.v?e:{type:M,size:e.size,array:N(e.array,u,{type:L,k:n,v:i})}:(s.val=!0,{type:M,size:e.size,array:N(e.array,u,br(t+P,l.k,l.v,r,n,i))});let a=Ae(l,t+P,r,n,i,s);return a===l?e:{type:M,size:e.size,array:N(e.array,u,a)}}function Dt(e,t,r,n,i,s){let u=rt(r,t),l=Bt(e.bitmap,u);if(e.bitmap&u){let a=e.array[l];if(a.type!==L){let h=Ae(a,t+P,r,n,i,s);return h===a?e:{type:S,bitmap:e.bitmap,array:N(e.array,l,h)}}let f=a.k;return $(n,f)?i===a.v?e:{type:S,bitmap:e.bitmap,array:N(e.array,l,{type:L,k:n,v:i})}:(s.val=!0,{type:S,bitmap:e.bitmap,array:N(e.array,l,br(t+P,f,a.v,r,n,i))})}else{let a=e.array.length;if(a>=Qn){let f=new Array(32),h=Ee(r,t);f[h]=Dt(It,t+P,r,n,i,s);let F=0,j=e.bitmap;for(let E=0;E<32;E++){if(j&1){let ge=e.array[F++];f[E]=ge}j=j>>>1}return{type:M,size:a+1,array:f}}else{let f=ri(e.array,l,{type:L,k:n,v:i});return s.val=!0,{type:S,bitmap:e.bitmap|u,array:f}}}}function ii(e,t,r,n,i,s){if(r===e.hash){let u=Mt(e,n);if(u!==-1)return e.array[u].v===i?e:{type:Q,hash:r,array:N(e.array,u,{type:L,k:n,v:i})};let l=e.array.length;return s.val=!0,{type:Q,hash:r,array:N(e.array,l,{type:L,k:n,v:i})}}return Ae({type:S,bitmap:rt(e.hash,t),array:[e]},t,r,n,i,s)}function Mt(e,t){let r=e.array.length;for(let n=0;n<r;n++)if($(t,e.array[n].k))return n;return-1}function tt(e,t,r,n){switch(e.type){case M:return si(e,t,r,n);case S:return oi(e,t,r,n);case Q:return ui(e,n)}}function si(e,t,r,n){let i=Ee(r,t),s=e.array[i];if(s!==void 0){if(s.type!==L)return tt(s,t+P,r,n);if($(n,s.k))return s}}function oi(e,t,r,n){let i=rt(r,t);if(!(e.bitmap&i))return;let s=Bt(e.bitmap,i),u=e.array[s];if(u.type!==L)return tt(u,t+P,r,n);if($(n,u.k))return u}function ui(e,t){let r=Mt(e,t);if(!(r<0))return e.array[r]}function Pt(e,t,r,n){switch(e.type){case M:return li(e,t,r,n);case S:return ci(e,t,r,n);case Q:return ai(e,n)}}function li(e,t,r,n){let i=Ee(r,t),s=e.array[i];if(s===void 0)return e;let u;if(s.type===L){if(!$(s.k,n))return e}else if(u=Pt(s,t+P,r,n),u===s)return e;if(u===void 0){if(e.size<=ei){let l=e.array,a=new Array(e.size-1),f=0,h=0,F=0;for(;f<i;){let j=l[f];j!==void 0&&(a[h]=j,F|=1<<f,++h),++f}for(++f;f<l.length;){let j=l[f];j!==void 0&&(a[h]=j,F|=1<<f,++h),++f}return{type:S,bitmap:F,array:a}}return{type:M,size:e.size-1,array:N(e.array,i,u)}}return{type:M,size:e.size,array:N(e.array,i,u)}}function ci(e,t,r,n){let i=rt(r,t);if(!(e.bitmap&i))return e;let s=Bt(e.bitmap,i),u=e.array[s];if(u.type!==L){let l=Pt(u,t+P,r,n);return l===u?e:l!==void 0?{type:S,bitmap:e.bitmap,array:N(e.array,s,l)}:e.bitmap===i?void 0:{type:S,bitmap:e.bitmap^i,array:zt(e.array,s)}}return $(n,u.k)?e.bitmap===i?void 0:{type:S,bitmap:e.bitmap^i,array:zt(e.array,s)}:e}function ai(e,t){let r=Mt(e,t);if(r<0)return e;if(e.array.length!==1)return{type:Q,hash:e.hash,array:zt(e.array,r)}}function kr(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===L){t(s.v,s.k);continue}kr(s,t)}}}var ee=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=tt(this.root,0,z(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?It:this.root,s=Ae(i,0,z(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Pt(this.root,0,z(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:tt(this.root,0,z(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){kr(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+Ct(z(r),z(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;let r=!0;return this.forEach((n,i)=>{r=r&&$(t.get(i,!n),n)}),r}};var Lr=void 0,Or={};function jr(e){return/^[-+]?(\d+)$/.test(e)?new d(parseInt(e)):new m(Lr)}function Er(e){return e.toString()}function bt(e){let t=fi(e);return t?A.fromArray(Array.from(t).map(r=>r.segment)):A.fromArray(e.match(/./gsu))}function fi(e){if(globalThis.Intl&&Intl.Segmenter)return new Intl.Segmenter().segment(e)[Symbol.iterator]()}function mr(e,t){return A.fromArray(e.split(t))}function kt(e){let t="";for(let r of e)t=t+r;return t}var Ar=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),iu=new RegExp(`^([${Ar}]*)`,"g"),su=new RegExp(`([${Ar}]*)$`,"g");function Sr(e){console.log(e)}function qr(e){typeof process=="object"&&process.stderr?.write?process.stderr.write(e+`
`):typeof Deno=="object"?Deno.stderr.writeSync(new TextEncoder().encode(e+`
`)):console.log(e)}function ur(e,t){let r=e.get(t,Or);return r===Or?new m(Lr):new d(r)}function At(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof se)return"Result";if(e instanceof A)return"List";if(e instanceof be)return"BitArray";if(e instanceof ee)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function Rt(e,t){return pi(e,At(t))}function pi(e,t){return new m(A.fromArray([new de(e,t,A.fromArray([]))]))}function xr(e){return typeof e=="string"?new d(e):Rt("String",e)}function $r(e){return Number.isInteger(e)?new d(e):Rt("Int",e)}function wr(e,t){let r=()=>Rt("Dict",e);if(e instanceof ee||e instanceof WeakMap||e instanceof Map){let n=ur(e,t);return new d(n.isOk()?new g(n[0]):new y)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?vr(e,t,()=>new d(new y)):vr(e,t,r)}function vr(e,t,r){try{return t in e?new d(new g(e[t])):r()}catch{return r()}}function B(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return di(e);if(t==="bigint"||t==="number")return e.toString();if(Array.isArray(e))return`#(${e.map(B).join(", ")})`;if(e instanceof A)return xi(e);if(e instanceof Ke)return wi(e);if(e instanceof be)return $i(e);if(e instanceof c)return hi(e);if(e instanceof ee)return mi(e);if(e instanceof Set)return`//js(Set(${[...e].map(B).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let r=[];for(let n of Array(e.length).keys())r.push(String.fromCharCode(n+97));return`//fn(${r.join(", ")}) { ... }`}return _i(e)}function di(e){let t='"';for(let r=0;r<e.length;r++){let n=e[r];switch(n){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:n<" "||n>"~"&&n<"\xA0"?t+="\\u{"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=n}}return t+='"',t}function mi(e){let t="dict.from_list([",r=!0;return e.forEach((n,i)=>{r||(t=t+", "),t=t+"#("+B(i)+", "+B(n)+")",r=!1}),t+"])"}function _i(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",r=[];for(let s of Object.keys(e))r.push(`${B(s)}: ${B(e[s])}`);let n=r.length?" "+r.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${n}})`}function hi(e){let t=Object.keys(e).map(r=>{let n=B(e[r]);return isNaN(parseInt(r))?`${r}: ${n}`:n}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function xi(e){return`[${e.toArray().map(B).join(", ")}]`}function $i(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function wi(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function nt(e){return jr(e)}function D(e){return Er(e)}function Tr(e){return Sr(e)}function Ut(e){let r=vt(e);return qr(r),e}var Se=class extends c{constructor(t,r,n,i,s,u,l){super(),this.scheme=t,this.userinfo=r,this.host=n,this.port=i,this.path=s,this.query=u,this.fragment=l}};function yi(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return I(n);{let i=r.head,s=r.tail,u=i===""||i==="."?n:i===".."&&n.hasLength(0)?o([]):i===".."&&n.atLeastLength(1)?n.tail:b(i,n);e=s,t=u}}}function bi(e){return yi(e,o([]))}function zr(e){return bi(Ot(e,"/"))}function qe(e,t,r){return e?t:r()}var Te=class extends c{constructor(t){super(),this.all=t}};function R(e){return new Te(o([(t,r)=>e(t)]))}function me(){return new Te(o([]))}function Fr(e){return new Te(fe(e,o([]),(t,r)=>{let n=r.all;return ae(t,n)}))}var Ce=class extends c{constructor(t){super(),this.content=t}},k=class extends c{constructor(t,r,n,i,s,u,l){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=s,this.self_closing=u,this.void=l}};var ze=class extends c{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},Ne=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}};function _e(e,t){return new ze(e,t,!1)}function Br(e,t){return new Ne("on"+e,t)}function p(e){return _e("class",e)}function te(e){return _e("id",e)}function st(e){return _e("value",e)}function Dr(e){return _e("name",e)}function Mr(e){return _e("for",e)}function Pr(e){return _e("href",e)}function _(e,t,r){return e==="area"?new k("","",e,t,o([]),!1,!0):e==="base"?new k("","",e,t,o([]),!1,!0):e==="br"?new k("","",e,t,o([]),!1,!0):e==="col"?new k("","",e,t,o([]),!1,!0):e==="embed"?new k("","",e,t,o([]),!1,!0):e==="hr"?new k("","",e,t,o([]),!1,!0):e==="img"?new k("","",e,t,o([]),!1,!0):e==="input"?new k("","",e,t,o([]),!1,!0):e==="link"?new k("","",e,t,o([]),!1,!0):e==="meta"?new k("","",e,t,o([]),!1,!0):e==="param"?new k("","",e,t,o([]),!1,!0):e==="source"?new k("","",e,t,o([]),!1,!0):e==="track"?new k("","",e,t,o([]),!1,!0):e==="wbr"?new k("","",e,t,o([]),!1,!0):new k("","",e,t,r,!1,!1)}function U(e){return new Ce(e)}var ot=class extends c{constructor(t){super(),this[0]=t}},H=class extends c{constructor(t){super(),this[0]=t}};var re=class extends c{};var ut=class extends c{constructor(t){super(),this[0]=t}};function Jt(e,t,r,n=!1){let i,s=[{prev:e,next:t,parent:e.parentNode}];for(;s.length;){let{prev:u,next:l,parent:a}=s.pop();if(l.subtree!==void 0&&(l=l.subtree()),l.content!==void 0)if(u)if(u.nodeType===Node.TEXT_NODE)u.textContent!==l.content&&(u.textContent=l.content),i??=u;else{let f=document.createTextNode(l.content);a.replaceChild(f,u),i??=f}else{let f=document.createTextNode(l.content);a.appendChild(f),i??=f}else if(l.tag!==void 0){let f=Mi({prev:u,next:l,dispatch:r,stack:s,isComponent:n});u?u!==f&&a.replaceChild(f,u):a.appendChild(f),i??=f}else l.elements!==void 0?he(l,f=>{s.unshift({prev:u,next:f,parent:a}),u=u?.nextSibling}):l.subtree!==void 0&&s.push({prev:u,next:l,parent:a})}return i}function Mi({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),u=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),l;if(Fe.has(u))l=Fe.get(u);else{let O=new Map;Fe.set(u,O),l=O}let a=s?new Set(l.keys()):null,f=s?new Set(Array.from(e.attributes,O=>O.name)):null,h=null,F=null,j=null;for(let O of t.attrs){let x=O[0],T=O[1];if(O.as_property)u[x]!==T&&(u[x]=T),s&&f.delete(x);else if(x.startsWith("on")){let G=x.slice(2),mt=r(T);l.has(G)||u.addEventListener(G,Ie),l.set(G,mt),s&&a.delete(G)}else if(x.startsWith("data-lustre-on-")){let G=x.slice(15),mt=r(Pi);l.has(G)||u.addEventListener(G,Ie),l.set(G,mt),u.setAttribute(x,T)}else x==="class"?h=h===null?T:h+" "+T:x==="style"?F=F===null?T:F+T:x==="dangerous-unescaped-html"?j=T:(u.getAttribute(x)!==T&&u.setAttribute(x,T),(x==="value"||x==="selected")&&(u[x]=T),s&&f.delete(x))}if(h!==null&&(u.setAttribute("class",h),s&&f.delete("class")),F!==null&&(u.setAttribute("style",F),s&&f.delete("style")),s){for(let O of f)u.removeAttribute(O);for(let O of a)l.delete(O),u.removeEventListener(O,Ie)}if(t.key!==void 0&&t.key!=="")u.setAttribute("data-lustre-key",t.key);else if(j!==null)return u.innerHTML=j,u;let E=u.firstChild,ge=null,nr=null,ir=null,dt=t.children[Symbol.iterator]().next().value;s&&dt!==void 0&&dt.key!==void 0&&dt.key!==""&&(ge=new Set,nr=Ur(e),ir=Ur(t));for(let O of t.children)he(O,x=>{x.key!==void 0&&ge!==null?E=Ri(E,x,u,n,ir,nr,ge):(n.unshift({prev:E,next:x,parent:u}),E=E?.nextSibling)});for(;E;){let O=E.nextSibling;u.removeChild(E),E=O}return u}var Fe=new WeakMap;function Ie(e){let t=e.currentTarget;if(!Fe.has(t)){t.removeEventListener(e.type,Ie);return}let r=Fe.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,Ie);return}r.get(e.type)(e)}function Pi(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((s,u)=>{let l=u.split(".");for(let a=0,f=s,h=e;a<l.length;a++)a===l.length-1?f[l[a]]=h[l[a]]:(f[l[a]]??={},h=h[l[a]],f=f[l[a]]);return s},{data:n})}}function Ur(e){let t=new Map;if(e)for(let r of e.children)he(r,n=>{let i=n?.key||n?.getAttribute?.("data-lustre-key");i&&t.set(i,n)});return t}function Ri(e,t,r,n,i,s,u){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let a=e.nextSibling;r.removeChild(e),e=a}if(s.size===0)return he(t,a=>{n.unshift({prev:e,next:a,parent:r}),e=e?.nextSibling}),e;if(u.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;u.add(t.key);let l=s.get(t.key);if(!l&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!l&&e!==null){let a=document.createTextNode("");return r.insertBefore(a,e),n.unshift({prev:a,next:t,parent:r}),e}return!l||l===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(l,e),n.unshift({prev:l,next:t,parent:r}),e)}function he(e,t){if(e.elements!==void 0)for(let r of e.elements)he(r,t);else e.subtree!==void 0?he(e.subtree(),t):t(e)}var lt=class e{#e=null;#r=[];#t=[];#n=!1;#o=!1;#i=null;#u=null;#s=null;static start(t,r,n,i,s){if(!xe())return new m(new $e);let u=r instanceof HTMLElement?r:document.querySelector(r);if(!u)return new m(new ct(r));let l=new e(n(t),i,s,u);return new d(a=>l.send(a))}constructor([t,r],n,i,s=document.body,u=!1){this.#i=t,this.#u=n,this.#s=i,this.#e=s,this.#t=r.all.toArray(),this.#n=!0,this.#o=u,window.requestAnimationFrame(()=>this.#l())}send(t){switch(!0){case t instanceof H:{this.#r.push(t[0]),this.#l();return}case t instanceof re:{this.#f();return}case t instanceof ot:{this.#a(t[0]);return}default:return}}emit(t,r){this.#e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:r,composed:!0}))}#l(){if(this.#c(),this.#n){let t=this.#s(this.#i),r=n=>i=>{let s=n(i);s instanceof d&&this.send(new H(s[0]))};this.#n=!1,this.#e=Jt(this.#e,t,r,this.#o)}}#c(t=0){for(;this.#r.length;){let[r,n]=this.#u(this.#i,this.#r.shift());this.#n||=this.#i!==r,this.#i=r,this.#t=this.#t.concat(n.all.toArray())}for(;this.#t.length;)this.#t.shift()(r=>this.send(new H(r)),(r,n)=>this.emit(r,n));this.#r.length&&(t<5?this.#c(++t):window.requestAnimationFrame(()=>this.#l()))}#a(t){switch(!0){case t instanceof ut:{let r=this.#s(t[0]),n=i=>s=>{let u=i(s);u instanceof d&&this.send(new H(u[0]))};this.#r=[],this.#t=[],this.#n=!1,this.#e=Jt(this.#e,r,n,this.#o)}}}#f(){this.#e.remove(),this.#e=null,this.#i=null,this.#r=[],this.#t=[],this.#n=!1,this.#u=()=>{},this.#s=()=>{}}},Hr=(e,t,r)=>lt.start(r,t,e.init,e.update,e.view),xe=()=>globalThis.window&&window.document;var Wr=e=>e.preventDefault();var Vt=class extends c{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var ct=class extends c{constructor(t){super(),this.selector=t}},$e=class extends c{};function Gr(e,t,r){return new Vt(e,t,r,new y)}function Jr(e,t,r){return qe(!xe(),new m(new $e),()=>Hr(e,t,r))}function q(e){return U(e)}function Yr(e,t){return _("h1",e,t)}function Kr(e,t){return _("h2",e,t)}function Xr(e,t){return _("nav",e,t)}function w(e,t){return _("div",e,t)}function Zr(e,t){return _("li",e,t)}function Qr(e,t){return _("p",e,t)}function en(e,t){return _("ul",e,t)}function tn(e,t){return _("a",e,t)}function rn(e,t){return _("table",e,t)}function nn(e,t){return _("tbody",e,t)}function at(e,t){return _("td",e,t)}function sn(e,t){return _("th",e,t)}function on(e,t){return _("thead",e,t)}function Yt(e,t){return _("tr",e,t)}function V(e,t){return _("button",e,t)}function Kt(e,t){return _("form",e,t)}function Xt(e){return _("input",e,o([]))}function ft(e,t){return _("label",e,t)}function un(e,t){return _("option",e,o([U(t)]))}function ln(e,t){return _("select",e,t)}function Zt(e,t){return Br(e,t)}function Y(e){return Zt("click",t=>new d(e))}function Hi(e){let t=e;return Et("target",Et("value",jt))(t)}function Qt(e){return Zt("input",t=>{let r=Hi(t);return pe(r,e)})}function cn(e){return Zt("submit",t=>{let r=Wr(t);return new d(e)})}var Gi={handle_external_links:!1,handle_internal_links:!0},Bf=window?.location?.href;var er=(e,t=Gi)=>{document.addEventListener("click",r=>{let n=fn(r.target);if(n)try{let i=new URL(n.href),s=an(i),u=i.host!==window.location.host;return!t.handle_external_links&&u||!t.handle_internal_links&&!u?void 0:(r.preventDefault(),u||(window.history.pushState({},"",n.href),window.requestAnimationFrame(()=>{i.hash&&document.getElementById(i.hash.slice(1))?.scrollIntoView()})),e(s))}catch{return}}),window.addEventListener("popstate",r=>{r.preventDefault();let n=new URL(window.location.href),i=an(n);window.requestAnimationFrame(()=>{n.hash&&document.getElementById(n.hash.slice(1))?.scrollIntoView()}),e(i)}),window.addEventListener("modem-push",({detail:r})=>{e(r)}),window.addEventListener("modem-replace",({detail:r})=>{e(r)})};var fn=e=>!e||e.tagName==="BODY"?null:e.tagName==="A"?e:fn(e.parentElement),an=e=>new Se(e.protocol?new g(e.protocol.slice(0,-1)):new y,new y,e.hostname?new g(e.hostname):new y,e.port?new g(Number(e.port)):new y,e.pathname,e.search?new g(e.search.slice(1)):new y,e.hash?new g(e.hash.slice(1)):new y);function pn(e){return R(t=>qe(!xe(),void 0,()=>er(r=>{let i=e(r);return t(i)})))}function dn(e,t){window.localStorage.setItem(e,String(t))}function mn(e){let t=window.localStorage.getItem(e);return t?new d(t):new m(void 0)}function _n(e,t){let r=document.getElementById(e);r&&r.classList.add(t)}function hn(e,t){let r=document.getElementById(e);r&&r.classList.remove(t)}var we=class extends c{},Re=class extends c{},pt=class extends c{},Be=class extends c{constructor(t,r){super(),this.id=t,this.label=r}},tr=class extends c{constructor(t,r,n,i,s,u,l,a){super(),this.current_route=t,this.count=r,this.current_task=n,this.task_options=i,this.work_items=s,this.new_work_item_id=u,this.new_work_item_label=l,this.new_work_item_modal_open=a}};var Ue=class extends c{},He=class extends c{},We=class extends c{},ne=class extends c{constructor(t){super(),this[0]=t}},Ge=class extends c{},De=class extends c{},Me=class extends c{},ie=class extends c{},Je=class extends c{constructor(t){super(),this.id=t}},Ve=class extends c{constructor(t){super(),this.label=t}},rr=class extends c{constructor(t,r){super(),this.id=t,this.label=r}},Pe=class extends c{constructor(t,r,n){super(),this.url=t,this.title=r,this.route=n}};function Vi(e){let t=zr(e.path);return t.hasLength(1)&&t.head==="work-items"?new ne(new Re):t.hasLength(1)&&t.head==="analytics"?new ne(new pt):new ne(new we)}function Yi(){return w(o([]),o([Yr(o([p("text-3xl")]),o([U("Time tracker")])),Qr(o([]),o([U("A small app to track your time spent on work items.")]))]))}function xn(){return w(o([p("border-b-2 border-b-surface-0")]),o([]))}function Ki(e){return w(o([p("w-full h-8 flex flex-col justify-center")]),o([Xr(o([p("w-full")]),o([en(o([p("flex w-full")]),C(e,r=>Zr(o([p("mx-auto")]),o([tn(o([Pr(r.url)]),o([q(r.title)]))]))))]))]))}function Xi(){return V(o([p("rounded-full h-4/5 aspect-square bg-green-500 hover:bg-green-600 duration-200 border-[3px] border-green-900 flex items-center justify-center")]),o([w(o([p("ml-2 border-t-[15px] border-t-transparent border-b-transparent w-0 h-0 border-b-[15px] border-l-[25px] border-white")]),o([]))]))}function Zi(e){return w(o([]),o([w(o([p("flex gap-4")]),o([V(o([Y(new Ue)]),o([U("+")])),U(D(e.count)),V(o([Y(new He)]),o([U("-")]))])),w(o([p("w-full")]),o([V(o([Y(new We)]),o([U("Reset")]))])),w(o([p("w-full h-32 rounded-lg bg-surface-0 flex px-8 py-2 items-center")]),o([w(o([p("mx-auto flex-col")]),o([Kt(o([p("flex flex-col")]),o([w(o([p("flex gap-2")]),o([ft(o([Mr("work-item")]),o([q("Work item")])),ln(o([Dr("selected-work-item"),te("work-item"),p("text-bg")]),(()=>{let t=o(["A","B","C"]);return C(t,r=>un(o([st(r)]),r))})())]))]))])),Xi()]))]))}function Qi(e){let t=(()=>{let n=o(["ID","Label","Action"]);return C(n,i=>sn(o([]),o([q(i)])))})(),r=(()=>{let n=e.work_items;return Ze(n,(i,s)=>{let u=ke(s,2)===0?"":"bg-surface-1";return Yt(o([p(u)]),o([at(o([p("text-center")]),o([q(i.id)])),at(o([p("text-center")]),o([q(i.label)])),at(o([p("text-center")]),o([q("")]))]))})})();return rn(o([p("w-full table-auto rounded-md")]),o([on(o([p("rounded-md")]),o([Yt(o([p("bg-surface-1 text-white rounded-md")]),t)])),nn(o([]),r)]))}function es(e){let t=e.new_work_item_modal_open?["block",""]:["hidden","scale-75"],r=t[0],n=t[1],i=w(o([te("modal-add-work-item"),p("max-w-5xl w-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-surface-1 opacity-100 rounded-lg flex flex-col gap-4 p-4 z-999 duration-2000 transition"+n)]),o([Kr(o([p("text-xl font-semibold")]),o([q("Add new work item")])),Kt(o([p("flex flex-col gap-4"),cn(new rr(e.new_work_item_id,e.new_work_item_label))]),o([w(o([p("flex justify-center gap-4")]),o([ft(o([p("mb-1 mt-1 min-w-32")]),o([q("ID:")])),Xt(o([te("id-work-item"),p("text-bg rounded-md grow px-4 py-1"),st(e.new_work_item_id),Qt(u=>new Je(u))]))])),w(o([p("flex justify-center gap-4")]),o([ft(o([p("mb-1 mt-1 min-w-32")]),o([q("Label:")])),Xt(o([te("label-work-item"),p("text-bg rounded-md grow px-4 py-1"),st(e.new_work_item_label),Qt(u=>new Ve(u))]))]))])),w(o([p("flex w-full gap-4")]),o([V(o([p("h-8 rounded-lg bg-teal-300 text-bg w-1/2"),Y(new ie)]),o([q("Save")])),V(o([p("h-8 rounded-lg bg-red-400 text-bg w-1/2"),Y(new ie)]),o([q("Cancel")]))]))])),s=w(o([te("modal-bg"),p("bg-bg opacity-90 w-screen h-screen z-990"),Y(new ie)]),o([]));return w(o([te("modal-add-work-item-container"),p("absolute top-0 left-0 w-screen h-screen overflow-hidden z-1 flex flex-col "+r)]),o([w(o([p("w-full h-full relative")]),o([s,i]))]))}function ts(e){return w(o([p("flex flex-col gap-4")]),o([Qi(e),V(o([p("bg-catp-green w-full h-8 rounded-lg text-bg"),Y(new Ge)]),o([q("Add new item")]))]))}function rs(e){return w(o([]),o([]))}function ns(e){let t=o([new Pe("/","Tracker",new we),new Pe("/work-items","Work Items",new Re),new Pe("/analytics","Analytics",new pt)]),r=(()=>{let n=e.current_route;return n instanceof we?Zi(e):n instanceof Re?ts(e):rs(e)})();return w(o([p("text-white container p-4 mx-auto max-w-5xl sm:mt-8 mt-4 flex flex-col gap-4")]),o([Yi(),xn(),Ki(t),xn(),r,es(e)]))}function is(e){let t=D(e.count);return Ut("Writing model to local storage: count="+t),dn("count",t)}function ss(e,t){let r=(()=>{if(t instanceof Ue)return e.withFields({count:e.count+1});if(t instanceof He)return e.count>1?e.withFields({count:e.count-1}):e.withFields({count:0});if(t instanceof We)return e.withFields({count:0});if(t instanceof ne){let s=t[0];return Tr("On route change triggered"),e.withFields({current_route:s})}else{if(t instanceof Ge)return e;if(t instanceof De)return e.withFields({new_work_item_modal_open:!0});if(t instanceof Me)return e.withFields({new_work_item_modal_open:!1});if(t instanceof ie)return e.withFields({new_work_item_id:"",new_work_item_label:""});if(t instanceof Je){let s=t.id;return e.withFields({new_work_item_id:s})}else if(t instanceof Ve){let s=t.label;return e.withFields({new_work_item_label:s})}else{let s=t.id,u=t.label;return e}}})(),n=s=>is(r),i=(()=>{if(t instanceof Ue)return R(n);if(t instanceof He)return R(n);if(t instanceof We)return R(n);if(t instanceof Ge)return R(s=>(Ut("Modal opened"),s(new De)));if(t instanceof ne)return me();if(t instanceof De)return R(s=>hn("modal-add-work-item","scale-75"));if(t instanceof Me)return R(s=>_n("modal-add-work-item","scale-75"));if(t instanceof ie)return R(s=>s(new Me));if(t instanceof Je){let s=t.id;return me()}else if(t instanceof Ve){let s=t.label;return me()}else{let s=t.id,u=t.label;return me()}})();return[r,i]}function os(e){let t=(()=>{let i=mn("count");if(i.isOk()){let s=i[0],u=nt(s);return u.isOk()?u[0]:0}else return 0})(),r=o([new Be("hi","Hi"),new Be("bye","Bye"),new Be("ciao","Ciao")]),n=Fr(o([pn(Vi)]));return[new tr(new we,t,"",o([]),r,"","",!1),n]}function $n(){let e=Gr(os,ss,ns),t=Jr(e,"#app",void 0);if(!t.isOk())throw ht("assignment_no_match","timetracker_gleam",441,"main","Assignment pattern did not match",{value:t})}$n();
